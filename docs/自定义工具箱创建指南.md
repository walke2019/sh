# è‡ªå®šä¹‰å·¥å…·ç®±åˆ›å»ºæŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®åŸºäº [kejilion/sh](https://github.com/kejilion/sh) ä¸Šæ¸¸é¡¹ç›®ï¼Œæ˜¯ä¸€ä¸ª Linux Shell è„šæœ¬å·¥å…·ç®±ã€‚ä¸ºäº†åœ¨ä¿æŒä¸Šæ¸¸æ›´æ–°çš„åŒæ—¶æ·»åŠ è‡ªå·±çš„è‡ªå®šä¹‰åŠŸèƒ½ï¼Œéœ€è¦åˆ›å»ºç‹¬ç«‹çš„è‡ªå®šä¹‰å·¥å…·ç®±ç›®å½•ã€‚

---

## ğŸ—‚ï¸ æ¨èç›®å½•ç»“æ„

```
f:\é¡¹ç›®\sh\
â”œâ”€â”€ kejilion.sh              # ä¸Šæ¸¸ä¸»è„šæœ¬ï¼ˆä¸ä¿®æ”¹ï¼‰
â”œâ”€â”€ custom/                  # è‡ªå®šä¹‰å·¥å…·ç®±ç›®å½•ï¼ˆæ–°å»ºï¼‰
â”‚   â”œâ”€â”€ custom_main.sh       # è‡ªå®šä¹‰å·¥å…·ç®±ä¸»å…¥å£
â”‚   â”œâ”€â”€ tools/               # è‡ªå®šä¹‰å·¥å…·è„šæœ¬ç›®å½•
â”‚   â”‚   â”œâ”€â”€ tool1.sh
â”‚   â”‚   â”œâ”€â”€ tool2.sh
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ config/              # è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ settings.conf
â”‚   â”‚   â””â”€â”€ env.conf
â”‚   â””â”€â”€ README.md            # è‡ªå®šä¹‰å·¥å…·ç®±è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ docs/                    # é¡¹ç›®æ–‡æ¡£ç›®å½•
â”‚   â””â”€â”€ è‡ªå®šä¹‰å·¥å…·ç®±åˆ›å»ºæŒ‡å—.md
â””â”€â”€ .gitignore               # Git å¿½ç•¥é…ç½®
```

---

## ğŸš€ åˆ›å»ºæ­¥éª¤

### 1. åˆ›å»ºè‡ªå®šä¹‰å·¥å…·ç®±ç›®å½•

```powershell
# åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º custom ç›®å½•
New-Item -Path "f:\é¡¹ç›®\sh\custom" -ItemType Directory -Force
New-Item -Path "f:\é¡¹ç›®\sh\custom\tools" -ItemType Directory -Force
New-Item -Path "f:\é¡¹ç›®\sh\custom\config" -ItemType Directory -Force
```

### 2. åˆ›å»ºè‡ªå®šä¹‰å·¥å…·ç®±ä¸»å…¥å£è„šæœ¬

åˆ›å»º `custom/custom_main.sh` æ–‡ä»¶ï¼Œä½œä¸ºè‡ªå®šä¹‰å·¥å…·ç®±çš„ä¸»èœå•ï¼š

```bash
#!/bin/bash
# è‡ªå®šä¹‰å·¥å…·ç®±ä¸»å…¥å£
# ç‰ˆæœ¬: 1.0.0

# é¢œè‰²å®šä¹‰ï¼ˆä¸ä¸Šæ¸¸ä¿æŒä¸€è‡´ï¼‰
gl_hui='\e[37m'
gl_hong='\033[31m'
gl_lv='\033[32m'
gl_huang='\033[33m'
gl_lan='\033[34m'
gl_bai='\033[0m'
gl_zi='\033[35m'
gl_kjlan='\033[96m'

# è·å–è„šæœ¬æ‰€åœ¨ç›®å½•
CUSTOM_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
TOOLS_DIR="${CUSTOM_DIR}/tools"
CONFIG_DIR="${CUSTOM_DIR}/config"

# åŠ è½½é…ç½®æ–‡ä»¶
load_config() {
    if [ -f "${CONFIG_DIR}/settings.conf" ]; then
        source "${CONFIG_DIR}/settings.conf"
    fi
}

# è‡ªå®šä¹‰å·¥å…·ç®±ä¸»èœå•
custom_toolbox_menu() {
    while true; do
        clear
        echo -e "${gl_kjlan}"
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
        echo "â•‘    è‡ªå®šä¹‰å·¥å…·ç®± v1.0.0        â•‘"
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo -e "${gl_bai}"
        echo -e "${gl_kjlan}------------------------${gl_bai}"
        echo -e "${gl_kjlan}1.   ${gl_bai}è‡ªå®šä¹‰å·¥å…· 1"
        echo -e "${gl_kjlan}2.   ${gl_bai}è‡ªå®šä¹‰å·¥å…· 2"
        echo -e "${gl_kjlan}3.   ${gl_bai}è‡ªå®šä¹‰å·¥å…· 3"
        echo -e "${gl_kjlan}4.   ${gl_bai}é…ç½®ç®¡ç†"
        echo -e "${gl_kjlan}------------------------${gl_bai}"
        echo -e "${gl_kjlan}0.   ${gl_bai}è¿”å›ä¸Šçº§èœå•"
        echo -e "${gl_kjlan}------------------------${gl_bai}"
        read -e -p "è¯·è¾“å…¥ä½ çš„é€‰æ‹©: " choice

        case $choice in
            1)
                if [ -f "${TOOLS_DIR}/tool1.sh" ]; then
                    bash "${TOOLS_DIR}/tool1.sh"
                else
                    echo -e "${gl_hong}å·¥å…·è„šæœ¬ä¸å­˜åœ¨ï¼${gl_bai}"
                    sleep 2
                fi
                ;;
            2)
                if [ -f "${TOOLS_DIR}/tool2.sh" ]; then
                    bash "${TOOLS_DIR}/tool2.sh"
                else
                    echo -e "${gl_hong}å·¥å…·è„šæœ¬ä¸å­˜åœ¨ï¼${gl_bai}"
                    sleep 2
                fi
                ;;
            3)
                if [ -f "${TOOLS_DIR}/tool3.sh" ]; then
                    bash "${TOOLS_DIR}/tool3.sh"
                else
                    echo -e "${gl_hong}å·¥å…·è„šæœ¬ä¸å­˜åœ¨ï¼${gl_bai}"
                    sleep 2
                fi
                ;;
            4)
                config_menu
                ;;
            0)
                break
                ;;
            *)
                echo -e "${gl_hong}æ— æ•ˆçš„è¾“å…¥ï¼${gl_bai}"
                sleep 1
                ;;
        esac
    done
}

# é…ç½®ç®¡ç†èœå•
config_menu() {
    clear
    echo -e "${gl_kjlan}é…ç½®ç®¡ç†${gl_bai}"
    echo "åŠŸèƒ½å¼€å‘ä¸­..."
    sleep 2
}

# åŠ è½½é…ç½®å¹¶å¯åŠ¨ä¸»èœå•
load_config
custom_toolbox_menu
```

### 3. åˆ›å»ºç¤ºä¾‹å·¥å…·è„šæœ¬

åˆ›å»º `custom/tools/tool1.sh` ç¤ºä¾‹ï¼š

```bash
#!/bin/bash
# è‡ªå®šä¹‰å·¥å…· 1 - ç¤ºä¾‹è„šæœ¬

echo "================================"
echo "    è‡ªå®šä¹‰å·¥å…· 1 - ç¤ºä¾‹åŠŸèƒ½"
echo "================================"
echo ""
echo "è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹å·¥å…·è„šæœ¬"
echo "ä½ å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ è‡ªå·±çš„åŠŸèƒ½ä»£ç "
echo ""

# ç¤ºä¾‹åŠŸèƒ½ï¼šæ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯
echo "å½“å‰ç³»ç»Ÿä¿¡æ¯ï¼š"
uname -a
echo ""

read -p "æŒ‰å›è½¦é”®è¿”å›..." 
```

### 4. åˆ›å»ºé…ç½®æ–‡ä»¶

åˆ›å»º `custom/config/settings.conf`ï¼š

```bash
# è‡ªå®šä¹‰å·¥å…·ç®±é…ç½®æ–‡ä»¶

# å·¥å…·ç®±ç‰ˆæœ¬
CUSTOM_VERSION="1.0.0"

# è‡ªå®šä¹‰é…ç½®é¡¹
CUSTOM_SETTING_1="value1"
CUSTOM_SETTING_2="value2"

# ç¯å¢ƒå˜é‡é…ç½®
# export CUSTOM_VAR="custom_value"
```

### 5. åˆ›å»ºè‡ªå®šä¹‰å·¥å…·ç®±è¯´æ˜æ–‡æ¡£

åˆ›å»º `custom/README.md`ï¼š

```markdown
# è‡ªå®šä¹‰å·¥å…·ç®±

## ç®€ä»‹

è¿™æ˜¯åŸºäº kejilion.sh ä¸Šæ¸¸é¡¹ç›®çš„è‡ªå®šä¹‰å·¥å…·ç®±æ‰©å±•ã€‚

## ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨è‡ªå®šä¹‰å·¥å…·ç®±

```bash
bash custom/custom_main.sh
```

### æ·»åŠ æ–°å·¥å…·

1. åœ¨ `custom/tools/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„ `.sh` è„šæœ¬
2. åœ¨ `custom_main.sh` ä¸­æ·»åŠ èœå•é¡¹
3. èµ‹äºˆè„šæœ¬æ‰§è¡Œæƒé™ï¼š`chmod +x custom/tools/your_tool.sh`

## ç›®å½•ç»“æ„

- `custom_main.sh` - ä¸»å…¥å£è„šæœ¬
- `tools/` - å·¥å…·è„šæœ¬ç›®å½•
- `config/` - é…ç½®æ–‡ä»¶ç›®å½•

## æ³¨æ„äº‹é¡¹

- ä¸è¦ä¿®æ”¹ä¸Šæ¸¸ `kejilion.sh` æ–‡ä»¶
- æ‰€æœ‰è‡ªå®šä¹‰åŠŸèƒ½æ”¾åœ¨ `custom/` ç›®å½•ä¸‹
- å®šæœŸåŒæ­¥ä¸Šæ¸¸æ›´æ–°
```

---

## ğŸ”— é›†æˆåˆ°ä¸»è„šæœ¬ï¼ˆå¯é€‰ï¼‰

å¦‚æœæƒ³åœ¨ä¸»è„šæœ¬èœå•ä¸­æ·»åŠ è‡ªå®šä¹‰å·¥å…·ç®±å…¥å£ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªè¡¥ä¸è„šæœ¬ï¼š

åˆ›å»º `custom/integrate.sh`ï¼š

```bash
#!/bin/bash
# å°†è‡ªå®šä¹‰å·¥å…·ç®±é›†æˆåˆ°ä¸»è„šæœ¬çš„è¾…åŠ©è„šæœ¬

echo "é›†æˆè‡ªå®šä¹‰å·¥å…·ç®±åˆ°ä¸»èœå•..."

# æ£€æŸ¥æ˜¯å¦å·²ç»é›†æˆ
if grep -q "è‡ªå®šä¹‰å·¥å…·ç®±" ~/kejilion.sh 2>/dev/null; then
    echo "è‡ªå®šä¹‰å·¥å…·ç®±å·²ç»é›†æˆï¼"
    exit 0
fi

# å¤‡ä»½åŸå§‹è„šæœ¬
cp ~/kejilion.sh ~/kejilion.sh.backup

# åœ¨ä¸»èœå•ä¸­æ·»åŠ è‡ªå®šä¹‰å·¥å…·ç®±é€‰é¡¹
# æ³¨æ„ï¼šè¿™éœ€è¦æ ¹æ®å®é™…çš„ kejilion.sh ç‰ˆæœ¬è°ƒæ•´
echo "è¯·æ‰‹åŠ¨åœ¨ kejilion.sh ä¸»èœå•ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š"
echo ""
echo "åœ¨èœå•æ˜¾ç¤ºéƒ¨åˆ†æ·»åŠ ï¼š"
echo 'echo -e "${gl_kjlan}16.  ${gl_bai}è‡ªå®šä¹‰å·¥å…·ç®±"'
echo ""
echo "åœ¨ case è¯­å¥ä¸­æ·»åŠ ï¼š"
echo '16) bash custom/custom_main.sh ;;'
```

---

## ğŸ“ Git ç‰ˆæœ¬æ§åˆ¶é…ç½®

### æ›´æ–° .gitignore

åˆ›å»ºæˆ–æ›´æ–° `.gitignore` æ–‡ä»¶ï¼š

```gitignore
# ä¸Šæ¸¸æ–‡ä»¶ï¼ˆä¸æäº¤ï¼‰
kejilion.sh
kejilion_sh_log.txt
*.backup

# ä¿ç•™è‡ªå®šä¹‰ç›®å½•
!custom/

# é…ç½®æ–‡ä»¶ä¸­çš„æ•æ„Ÿä¿¡æ¯
custom/config/*.key
custom/config/*.secret

# ä¸´æ—¶æ–‡ä»¶
*.tmp
*.log
```

### Git åˆ†æ”¯ç­–ç•¥

å»ºè®®ä½¿ç”¨ä»¥ä¸‹åˆ†æ”¯ç­–ç•¥ï¼š

```bash
# ä¸»åˆ†æ”¯ï¼šè·Ÿè¸ªä¸Šæ¸¸
git checkout -b upstream

# è‡ªå®šä¹‰åˆ†æ”¯ï¼šå¼€å‘è‡ªå·±çš„åŠŸèƒ½
git checkout -b custom-dev

# å®šæœŸåŒæ­¥ä¸Šæ¸¸
git remote add upstream https://github.com/kejilion/sh.git
git fetch upstream
git merge upstream/main
```

---

## ğŸ”„ æ›´æ–°ç»´æŠ¤æµç¨‹

### åŒæ­¥ä¸Šæ¸¸æ›´æ–°

```bash
# 1. æ‹‰å–ä¸Šæ¸¸æœ€æ–°ä»£ç 
git fetch upstream
git checkout upstream
git merge upstream/main

# 2. åˆå¹¶åˆ°è‡ªå®šä¹‰åˆ†æ”¯
git checkout custom-dev
git merge upstream

# 3. è§£å†³å†²çªï¼ˆå¦‚æœæœ‰ï¼‰
# ç”±äºè‡ªå®šä¹‰åŠŸèƒ½åœ¨ custom/ ç›®å½•ä¸‹ï¼Œé€šå¸¸ä¸ä¼šæœ‰å†²çª
```

### æ·»åŠ æ–°å·¥å…·

```bash
# 1. åˆ›å»ºæ–°å·¥å…·è„šæœ¬
cd custom/tools
nano my_new_tool.sh

# 2. èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x my_new_tool.sh

# 3. åœ¨ custom_main.sh ä¸­æ·»åŠ èœå•é¡¹

# 4. æµ‹è¯•åŠŸèƒ½
bash custom/custom_main.sh

# 5. æäº¤æ›´æ”¹
git add custom/
git commit -m "æ·»åŠ æ–°å·¥å…·: my_new_tool"
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¸è¦ä¿®æ”¹ä¸Šæ¸¸æ–‡ä»¶**ï¼šæ‰€æœ‰è‡ªå®šä¹‰åŠŸèƒ½åº”æ”¾åœ¨ `custom/` ç›®å½•ä¸‹
2. **é…ç½®æ–‡ä»¶ç®¡ç†**ï¼šæ•æ„Ÿé…ç½®ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–ç‹¬ç«‹é…ç½®æ–‡ä»¶
3. **è„šæœ¬æƒé™**ï¼šç¡®ä¿æ‰€æœ‰ `.sh` æ–‡ä»¶æœ‰æ‰§è¡Œæƒé™
4. **è·¯å¾„å¼•ç”¨**ï¼šä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹äºè„šæœ¬çš„è·¯å¾„
5. **å®šæœŸå¤‡ä»½**ï¼šé‡è¦é…ç½®å’Œæ•°æ®å®šæœŸå¤‡ä»½
6. **æµ‹è¯•ç¯å¢ƒ**ï¼šæ–°åŠŸèƒ½å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯

---

## ğŸ“š æ‰©å±•å»ºè®®

### å·¥å…·åˆ†ç±»

å¯ä»¥æŒ‰åŠŸèƒ½å¯¹å·¥å…·è¿›è¡Œåˆ†ç±»ï¼š

```
custom/tools/
â”œâ”€â”€ system/          # ç³»ç»Ÿç®¡ç†å·¥å…·
â”œâ”€â”€ network/         # ç½‘ç»œå·¥å…·
â”œâ”€â”€ docker/          # Docker ç›¸å…³å·¥å…·
â”œâ”€â”€ database/        # æ•°æ®åº“å·¥å…·
â””â”€â”€ monitoring/      # ç›‘æ§å·¥å…·
```

### é…ç½®æ¨¡æ¿

ä¸ºä¸åŒç¯å¢ƒåˆ›å»ºé…ç½®æ¨¡æ¿ï¼š

```
custom/config/
â”œâ”€â”€ settings.conf           # ä¸»é…ç½®
â”œâ”€â”€ settings.dev.conf       # å¼€å‘ç¯å¢ƒ
â”œâ”€â”€ settings.prod.conf      # ç”Ÿäº§ç¯å¢ƒ
â””â”€â”€ settings.template.conf  # é…ç½®æ¨¡æ¿
```

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å¿«é€Ÿå¯åŠ¨è‡ªå®šä¹‰å·¥å…·ç®±ï¼Ÿ

A: å¯ä»¥åˆ›å»ºåˆ«åæˆ–å¿«æ·å‘½ä»¤ï¼š

```bash
# åœ¨ ~/.bashrc ä¸­æ·»åŠ 
alias ctool='bash /path/to/custom/custom_main.sh'

# æˆ–åˆ›å»ºè½¯é“¾æ¥
ln -s /path/to/custom/custom_main.sh /usr/local/bin/ctool
```

### Q: å¦‚ä½•åœ¨å·¥å…·è„šæœ¬ä¸­ä½¿ç”¨ä¸Šæ¸¸çš„å‡½æ•°ï¼Ÿ

A: å¯ä»¥åœ¨è‡ªå®šä¹‰è„šæœ¬ä¸­ source ä¸Šæ¸¸è„šæœ¬ï¼š

```bash
# åœ¨è‡ªå®šä¹‰è„šæœ¬å¼€å¤´
source ~/kejilion.sh
# ç„¶åå°±å¯ä»¥ä½¿ç”¨ä¸Šæ¸¸å®šä¹‰çš„å‡½æ•°å’Œå˜é‡
```

### Q: æ›´æ–°ä¸Šæ¸¸åè‡ªå®šä¹‰åŠŸèƒ½å¤±æ•ˆæ€ä¹ˆåŠï¼Ÿ

A: ç”±äºè‡ªå®šä¹‰åŠŸèƒ½ç‹¬ç«‹åœ¨ `custom/` ç›®å½•ï¼Œé€šå¸¸ä¸ä¼šå—å½±å“ã€‚å¦‚æœæœ‰é—®é¢˜ï¼Œæ£€æŸ¥ï¼š
1. è·¯å¾„å¼•ç”¨æ˜¯å¦æ­£ç¡®
2. ä¾èµ–çš„ä¸Šæ¸¸å‡½æ•°æ˜¯å¦æœ‰å˜åŒ–
3. é…ç½®æ–‡ä»¶æ˜¯å¦éœ€è¦æ›´æ–°

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- ä¸Šæ¸¸é¡¹ç›®ï¼šhttps://github.com/kejilion/sh
- è‡ªå®šä¹‰å·¥å…·ç®±é—®é¢˜ï¼šè¯·åœ¨é¡¹ç›® Issues ä¸­æå‡º

---

**æœ€åæ›´æ–°æ—¶é—´**: 2025-01-25
